# "col()" function, from pyspark.sql.functions is needed in order to rename the output column of our aggregate in the same operation

from pyspark.sql.functions import *

arrStateFlight = flightPerf \
			.filter("YEAR in (2014,2015,2016) AND DEST_STATE_NM IN ('California','Texas','Florida','Illinois','Georgia')") \
			.groupBy("YEAR","DEST_STATE_NM") \
			.count() \
			.select( flightPerf.YEAR.alias('Year') \
					,flightPerf.DEST_STATE_NM.alias('State') \
					,col("count").alias('NbrFlights'))
